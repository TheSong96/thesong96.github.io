<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/baby.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/baby.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/baby.png">
  <link rel="mask-icon" href="/images/baby.png" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Palatino:300,300italic,400,400italic,700,700italic|Monaco:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"thesong96.github.io","root":"/","scheme":"Mist","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"default"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="TheSong is named after IG.TheShy">
<meta property="og:type" content="website">
<meta property="og:title" content="TheSong">
<meta property="og:url" content="https://thesong96.github.io/index.html">
<meta property="og:site_name" content="TheSong">
<meta property="og:description" content="TheSong is named after IG.TheShy">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Nansong Yi">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://thesong96.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>TheSong</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/rss.xml" title="TheSong" type="application/rss+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">TheSong</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container"></div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="algolia-results">
  <div id="algolia-stats"></div>
  <div id="algolia-hits"></div>
  <div id="algolia-pagination" class="algolia-pagination"></div>
</div>

      
    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://thesong96.github.io/2026/10/20/TODO-POST/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/baby.png">
      <meta itemprop="name" content="Nansong Yi">
      <meta itemprop="description" content="TheSong is named after IG.TheShy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TheSong">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2026/10/20/TODO-POST/" class="post-title-link" itemprop="url">TODO POST</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2026-10-20 00:00:00" itemprop="dateCreated datePublished" datetime="2026-10-20T00:00:00-07:00">2026-10-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-16 10:28:29" itemprop="dateModified" datetime="2020-03-16T10:28:29-07:00">2020-03-16</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="ROS-Related"><a href="#ROS-Related" class="headerlink" title="ROS Related"></a>ROS Related</h2><p><strong>Python</strong></p>
<ul>
<li>list cv2.read 的几个mode, cvt用法example, br = cv_bridge() 方便查看 免得每次都google</li>
<li>rospy.Subscriber, <code>rospy.Publisher</code> classic example (oop style implementation</li>
<li>review CSE481C</li>
<li><code>rospy.Service</code>  review and classic example</li>
<li><code>rospy.Action</code> review and classic example</li>
</ul>
<p><strong>C++</strong></p>
<ul>
<li><a href="https://roboticsbackend.com/oop-with-ros-in-cpp/" target="_blank" rel="noopener">ROS C++ OOP style</a></li>
<li><a href="https://www.geeksforgeeks.org/unordered_map-at-cpp/" target="_blank" rel="noopener">hash map</a></li>
<li><a href="http://wiki.ros.org/image_transport/Tutorials/PublishingImages" target="_blank" rel="noopener">ROS image_transport publisher</a></li>
<li><a href="https://devel.iri.upc.edu/docs/roswiki/wiki/image_transport(2f)Tutorials(2f)SubscribingToImages.html" target="_blank" rel="noopener">ROS image_transport subscriber</a></li>
</ul>
<hr>
<h2 id="Linux-Related"><a href="#Linux-Related" class="headerlink" title="Linux Related"></a>Linux Related</h2><ul>
<li><a href="https://www.thegeekstuff.com/2008/10/execution-sequence-for-bash_profile-bashrc-bash_login-profile-and-bash_logout/" target="_blank" rel="noopener">sequence of bashrc</a></li>
</ul>
<h2 id="Git-Related"><a href="#Git-Related" class="headerlink" title="Git Related"></a>Git Related</h2><ul>
<li>自己两个号做一些 pr相关的试验</li>
</ul>
<hr>
<h2 id="Computer-Vision-Related"><a href="#Computer-Vision-Related" class="headerlink" title="Computer Vision Related"></a>Computer Vision Related</h2><h3 id="Camera-成像原理"><a href="#Camera-成像原理" class="headerlink" title="Camera 成像原理"></a>Camera 成像原理</h3><ul>
<li><p>Optical Flow</p>
</li>
<li><p><a href="https://thesong96.github.io/2020/02/27/Camera-Matrix/">Intrisic and Extrinsic Matrix</a></p>
</li>
<li><p>Terminology Review</p>
</li>
</ul>
<h3 id="Object-Detection"><a href="#Object-Detection" class="headerlink" title="Object Detection"></a>Object Detection</h3><ul>
<li>paper review + blog + algorithm reproduction</li>
<li>SPPNet</li>
<li>Selective Search</li>
<li>R-CNN</li>
<li>Fast-RCNN</li>
<li>Faster-RCNN</li>
<li>Yolo 1,2,3</li>
</ul>
<h3 id="Image-Segementation-Semantic-Segmentation"><a href="#Image-Segementation-Semantic-Segmentation" class="headerlink" title="Image Segementation/Semantic Segmentation"></a>Image Segementation/Semantic Segmentation</h3><ul>
<li><p>Vanilla FCN</p>
</li>
<li><p>U-Net</p>
</li>
<li><p>SegNet</p>
</li>
<li><p>DenseNet</p>
</li>
<li><p>BlitzNet</p>
</li>
<li><p>Mask-RCNN</p>
</li>
<li><p>Mask RCNN with the Fully Convolutional Network (FCN) branch achieved the highest performance.</p>
</li>
</ul>
<h3 id="Open-Course"><a href="#Open-Course" class="headerlink" title="Open Course"></a>Open Course</h3><ul>
<li>cs231接着搞完 然后 + blog review</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://thesong96.github.io/2020/03/21/MuSHR-Review/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/baby.png">
      <meta itemprop="name" content="Nansong Yi">
      <meta itemprop="description" content="TheSong is named after IG.TheShy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TheSong">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/21/MuSHR-Review/" class="post-title-link" itemprop="url">MuSHR Review</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-03-21 14:56:23" itemprop="dateCreated datePublished" datetime="2020-03-21T14:56:23-07:00">2020-03-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-22 23:37:33" itemprop="dateModified" datetime="2020-03-22T23:37:33-07:00">2020-03-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/PRL/" itemprop="url" rel="index"><span itemprop="name">PRL</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Acknowledgement: Xiangyu Xie.</p>
<p>This review is mainly done by Xiangyu Xie. 我只是做了一点微小的工作.</p>
<h1 id="Lab0"><a href="#Lab0" class="headerlink" title="Lab0"></a>Lab0</h1><ul>
<li><strong>Localization</strong>: Determine the pose of a robot relative to a given map of the environment.</li>
<li><strong>Mapping</strong>: Construct a map.</li>
<li><strong>Planning</strong>: </li>
</ul>
<h2 id="Bayes-filter-bayesian-update-rule"><a href="#Bayes-filter-bayesian-update-rule" class="headerlink" title="Bayes filter(bayesian update rule)"></a>Bayes filter(bayesian update rule)</h2><p>The <strong>Bayes filter algorithm</strong> includes two steps, the first step is prediction (push belief through dynamics given action), the second step is correction (apply Bayes rule given measurement).</p>
<p>$$<br>\begin{equation}<br>\begin{aligned}<br>\overline{bel}\left(x_{t}\right) &amp;= \int p\left(x_{t} \mid u_{t}, x_{t-1}\right) bel\left(x_{t-1}\right) d x_{t-1} \<br>bel\left(x_{t}\right) &amp;= \eta p\left(z_{t} \mid x_{t}\right) \overline{bel}\left(x_{t}\right)<br>\end{aligned}<br>\end{equation}<br>$$</p>
<h2 id="Kalman-filter"><a href="#Kalman-filter" class="headerlink" title="Kalman filter"></a>Kalman filter</h2><p><strong>Assumptions</strong>:</p>
<ol>
<li>Linear dynamics $p(x_t | u_t, x_{t-1}) = A_{t} x_{t-1}+B_{t} u_{t}+\varepsilon_{t}$, where $\varepsilon_t \sim \mathcal{N}(0, R_t)$</li>
<li>Linear measurement model $p(z_t | x_t) = C_{t} x_{t}+\delta_{t}$, where $\delta_t \sim \mathcal{N}(0, Q_t)$</li>
<li>Initial belief $bel(x_0)$ is a gaussian distribution<br>$$<br>bel\left(x_{0}\right)=p\left(x_{0}\right)=\operatorname{det}\left(2 \pi \Sigma_{0}\right)^{-\frac{1}{2}} \exp \left{-\frac{1}{2}\left(x_{0}-\mu_{0}\right)^{T} \Sigma_{0}^{-1}\left(x_{0}-\mu_{0}\right)\right}<br>$$</li>
</ol>
<p><strong>Algorithm</strong>:</p>
<p>$$<br>\mathbf{\text{Algorithm Kalman_filter(}}\mu_{t-1}, \Sigma_{t-1}, u_t, z_t \mathbf{):} \<br>\begin{align<em>}<br>\bar{\mu}<em>{t} &amp;=A</em>{t} \mu_{t-1}+B_{t} u_{t} \<br>\bar{\Sigma}<em>{t} &amp;=A</em>{t} \Sigma_{t-1} A_{t}^{T}+R_{t} \<br>K_{t} &amp;=\bar{\Sigma}<em>{t} C</em>{t-1}^{T}\left(C_{t} \bar{\Sigma}<em>{t} C</em>{t}^{T}+Q_{t}\right)^{-1} \<br>\mu_{t} &amp;=\bar{\mu}<em>{t}+K</em>{t}\left(z_{t}-C_{t} \bar{\mu}<em>{t}\right) \<br>\Sigma</em>{t} &amp;=\left(I-K_{t} C_{t}\right) \bar{\Sigma}<em>{t} \<br>&amp;\text{return } \mu</em>{t}, \Sigma_{t}<br>\end{align</em>}<br>$$</p>
<aside class="notice">
TODO(Nansong): 
- derive the bayes update rule for Kalman filter and EKF(which represent the present the state (also obeservation?) as probability distribution, i.e gussian distribution, arbitrary distribution)
- derive the bayes update rule by hand for particle filter(which represent the state as particles)
- analyze the pros and cons, i.e computational and storage expenses, which one is faster. or differences between Kalman Filter and Particle Filter, and specify cases where which algorithms fits better.
</aside>




<h1 id="Lab1"><a href="#Lab1" class="headerlink" title="Lab1"></a>Lab1</h1><h2 id="Motion-model"><a href="#Motion-model" class="headerlink" title="Motion model"></a>Motion model</h2><ul>
<li><strong>Kinematic model</strong>: map wheel speeds to robot velocities.</li>
<li><strong>Dynamic model</strong>: map wheel torques to robot accelerations.</li>
</ul>
<p>Consider only kinematic model $p(x_t | u_t, x_{t-1})$ for now (assume we can set the speed directly), then $x = [x, y, \theta]^T$, $u = [V, \delta]^T$, where $\theta$ is the heading and $\delta$ is the steering angle.</p>
<p>Now we will derive the motion model for rear axel. Note that a rigid body undergoing rotation and translation can be viewed as pure rotation about a instant center of rotation:</p>
<blockquote>
<p>Notes:</p>
<ul>
<li>How to find CoR? find two points(in our case, front wheels and rear wheels) in a rigid body and find their velocity vectors, the crosspoint of perpendicular lines of two velocity vectors is the CoR.<br><img src="https://codimd.s3.shivering-isles.com/demo/uploads/upload_cdea034260cfff09d98139707f3140b0.png" alt=""></li>
</ul>
</blockquote>
<p><mark>TODO: come up with or find other motion model examples apart from race car.</mark></p>
<p>$$<br>\begin{align<em>}<br>&amp;\dot{x}=V \cos (\theta)\<br>&amp;\dot{y}=V \sin (\theta)\<br>&amp;\dot{\theta}=\omega=\frac{V \tan \delta}{L}<br>\end{align</em>}<br>$$</p>
<p>With numerical integration we can get<br>$$<br>x_{t+1}=x_{t}+\frac{L}{\tan (\delta)}\left(\sin \left(\theta_{t+1}\right)-\sin \left(\theta_{t}\right)\right) \<br>y_{t+1}=y_{t}+\frac{L}{\tan (\delta)}\left(-\cos \left(\theta_{t+1}\right)+\cos \left(\theta_{t}\right)\right) \<br>\theta_{t+1}=\theta_{t}+\frac{v}{L} \tan (\delta) \Delta t \quad<br>$$</p>
<h3 id="noise"><a href="#noise" class="headerlink" title="noise"></a>noise</h3><ol>
<li>Control signal error: $\hat{V} \sim \mathcal{N}(V, \sigma_v^2)$, $\hat{\delta} \sim \mathcal{N}(\delta, \sigma_\delta^2)$</li>
<li>Incorrect physics (the Kinematic Model is inaccurate): $\hat{x} \sim \mathcal{N}\left(x, \sigma_{x}^{2}\right)$, $\hat{y} \sim \mathcal{N}\left(y, \sigma_{y}^{2}\right)$, $\hat{\theta} \sim \mathcal{N}\left(\theta, \sigma_{\theta}^{2}\right)$</li>
</ol>
<h2 id="Sensor-model"><a href="#Sensor-model" class="headerlink" title="Sensor model"></a>Sensor model</h2><p>$p(z_t | x_t, m)$ is the probability of sensor reading $z_t$ given state $x_t$ and map $m$. Calculate simulated sensor reading $z^*$ form $x$ and $m$ and then compare with $z$. </p>
<p>Assume individual beams are conditionally independent given map <mark>(may result in overconfidence problem)</mark>:<br>$$<br>p\left(z_{t} | x_{t}, m\right)=\prod_{i=1}^{K} p\left(z_{t}^{k} | x_{t}, m\right)<br>$$</p>
<h3 id="noise-1"><a href="#noise-1" class="headerlink" title="noise"></a>noise</h3><ol>
<li><p>Simple measurement noise in distance value<br> $$<br> p_{\text {hit }}\left(z_{t}^{k} | x_{t}, m\right)=\begin{cases}<br> \eta \mathcal{N}\left(z_{t}^{k} ; z_{t}^{k *}, \sigma_{\text {hit }}^{2}\right) &amp; \text { if } 0 \leq z_{t}^{k} \leq z_{\max } \<br> 0 &amp; \text { otherwise }<br> \end{cases}<br> $$</p>
</li>
<li><p>Presence of unexpected objects<br> $$<br> p_{\text {short }}\left(z_{t}^{k} | x_{t}, m\right)=\begin{cases}<br> \eta \lambda_{\text {short }} e^{-\lambda_{\text {short }} z_{t}^{k}} &amp; \text { if } 0 \leq z_{t}^{k} \leq z_{t}^{k *} \<br> 0 &amp; \text { otherwise }<br> \end{cases}<br> $$</p>
</li>
<li><p>Laser returns max range when no objects<br> $$<br> p_{\max }\left(z_{t}^{k} | x_{t}, m\right)=I\left(z=z_{\max }\right)=\begin{cases}<br> 1 &amp; \text { if } z=z_{\max } \<br> 0 &amp; \text { otherwise }<br> \end{cases}<br> $$</p>
</li>
<li><p>Failures in sensing<br> $$<br> p_{\text {rand }}\left(z_{t}^{k} | x_{t}, m\right)=\begin{cases}<br> \frac{1}{z_{\max }} &amp; \text { if } 0 \leq z_{t}^{k}&lt;z_{\max } \<br> 0 &amp; \text { otherwise }<br> \end{cases}<br> $$</p>
</li>
</ol>
<p>Combine these 4 model to get<br>$$<br>p\left(z_{t}^{k} | x_{t}, m\right)=\begin{pmatrix}<br>z_{\mathrm{hit}} \<br>z_{\text {short }} \<br>z_{\text {max }} \<br>z_{\text {rand }}<br>\end{pmatrix}^{T} \begin{pmatrix}<br>p_{\text {hit }}(z_{t}^{k} | x_{t}, m) \<br>p_{\text {short }}(z_{t}^{k} | x_{t}, m) \<br>p_{\text {max }}(z_{t}^{k} | x_{t}, m) \<br>p_{\text {rand }}(z_{t}^{k} | x_{t}, m)<br>\end{pmatrix}<br>$$</p>
<h2 id="Particle-filter"><a href="#Particle-filter" class="headerlink" title="Particle filter"></a>Particle filter</h2><p>The particle filter is an alternative <strong>nonparametric</strong> implementation of the Bayes filter. The key idea is to represent the posterior $bel(x_t)$ by a set of random state samples (particles) drawn from this posterior.<br>$$<br>\mathbf{\text{Algorithm Particle_filter(}} \mathcal{X}<em>{t-1}, u_t, z_t \mathbf{):} \<br>\begin{align*}<br>&amp;\bar{\mathcal{X}}</em>{t}=\mathcal{X}<em>{t}=\emptyset \<br>&amp;\text{for } m=1 \text{ to } M \text{ do} \<br>&amp;\qquad \text{sample } x</em>{t}^{[m]} \sim p\left(x_{t} \mid u_{t}, x_{t-1}^{[m]}\right) \<br>&amp;\qquad {w_{t}^{[m]}=p\left(z_{t} \mid x_{t}^{[m]}\right)} \<br>&amp;\qquad {\bar{\mathcal{X}}<em>{t}=\bar{\mathcal{X}}</em>{t}+\left\langle x_{t}^{[m]}, w_{t}^{[m]}\right\rangle} \<br>&amp;\text{endfor } \<br>&amp;\text{for } m = 1 \text{ to } M \text{ do} \<br>&amp;\qquad \text{draw } i \text{ with probability } \propto w_{t}^{[i]} \<br>&amp;\qquad \text{add } x_t^{[i]} \text{ to } \mathcal{X}_t \<br>&amp;\text{endfor} \<br>&amp;\text{return } \mathcal{X}_t<br>\end{align*}<br>$$</p>
<p>We first sample $x_t$ from the state transition distribution, then calculate the <strong>importance factor</strong>, $w_t$. In the next loop, we do the <strong>resampling</strong>/<strong>importance sampling</strong>, to change the distribution of particles from $\overline{bel}(x_t)$ to $bel(x_t)$.</p>
<h3 id="resample"><a href="#resample" class="headerlink" title="resample"></a>resample</h3><p>Resampling can cause high-variance (low-entropy) problem, where particles are depleted. Possible fixes:</p>
<ol>
<li>If the variance of weights low, don’t resample.</li>
<li>Use low-variance sampling.</li>
</ol>
<aside class="notice">
TODO(Nansong)
- explain normal importance sampling?
- differece between importance sampling and low-varience sampling? or is low-varience sampling is one method of importance sampling ?
</aside>

<p>$$<br>\mathbf{\text{Algorithm Low_variance_sampler(}} \mathcal{X}<em>{t}, \mathcal{W}</em>{t} \mathbf{):} \<br>\begin{align<em>}<br>&amp;\bar{X}<em>{t}=\emptyset \<br>&amp;r=\operatorname{rand}\left(0 ; M^{-1}\right) \<br>&amp;c=w</em>{t}^{[1]} \<br>&amp;i=1 \<br>&amp;\text{for } m=1 \text{ to } M \text{ do} \<br>&amp;\qquad U=r+(m-1) \cdot M^{-1} \<br>&amp;\qquad \text{while } U &gt; c \<br>&amp;\qquad\quad i=i+1 \<br>&amp;\qquad\quad c=c+w_{t}^{[i]} \<br>&amp;\qquad \text{endwhile} \<br>&amp;\qquad \text{add } x_{t}^{[i]} \text{ to } \bar{X}_{t} \<br>&amp;\text{endfor } \<br>&amp;\text{return } \bar{\mathcal{X}}_t<br>\end{align</em>}<br>$$</p>
<p><img src="https://codimd.s3.shivering-isles.com/demo/uploads/upload_4843cc831aa0cfd6384fbe8c8d4a1135.png" alt=""></p>
<aside class="notice">
TODO(Nansong):
- give a python implementation of this low varience resample algorithm
- give a python implementation of importance sampling of arbitrary probability distribution
</aside>



<h3 id="expected-pose"><a href="#expected-pose" class="headerlink" title="expected pose"></a>expected pose</h3><p>Calculate expected pose from particles: $x$ and $y$ can be computed directly by the weighted average. However, the weighted average of $\theta$ is not accurate. Thus we use cosine and sine averaging. (<a href="https://en.wikipedia.org/wiki/Mean_of_circular_quantities" target="_blank" rel="noopener">Ref</a>)</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><p><code>MotionModel.py</code>:</p>
<ol>
<li>Subscribe to motor topic, get control info (speed and steering angle), also save last frame info for calculation.</li>
<li>Add variance to speed and steering angle. Apply motion model on particles. Add variance to states.</li>
</ol>
<p><code>SensorModle.py</code>:</p>
<ol>
<li>Precompute the sensor model table and use <a href="https://github.com/kctess5/range_libc" target="_blank" rel="noopener">range_libc</a> package to achieve 2D raycasting for 2D occupancy grid.</li>
<li>Subscribe to scan topic, filter out invalid and extreme scan values, downsample, and pass processed data to update weights.</li>
</ol>
<p><code>ParticleFilter.py</code>:</p>
<ol>
<li>Transfer map to occupancy grid.</li>
<li>Globally initialize particles and weights. Initialize motion model and sensor model.</li>
<li>Subscribe to <code>/intialpose</code> topic, initialize particles and weights around initial pos.</li>
<li>When receiving scan infos, update weights, resample and calculate the expected pose for visualization.</li>
</ol>
<h1 id="Lab2"><a href="#Lab2" class="headerlink" title="Lab2"></a>Lab2</h1><table>
<thead>
<tr>
<th align="center"></th>
<th align="center">Uses Model</th>
<th align="center">Stability Guarantee</th>
<th align="center">Minimize Cost</th>
</tr>
</thead>
<tbody><tr>
<td align="center">PID</td>
<td align="center">No</td>
<td align="center">No</td>
<td align="center">No</td>
</tr>
<tr>
<td align="center">Pure Pursuit</td>
<td align="center">Circular arcs</td>
<td align="center">Yes - with assumptions</td>
<td align="center">No</td>
</tr>
<tr>
<td align="center">Lyapunov</td>
<td align="center">Non-linear</td>
<td align="center">Yes</td>
<td align="center">No</td>
</tr>
<tr>
<td align="center">LQR</td>
<td align="center">Linear</td>
<td align="center">Yes</td>
<td align="center">Quadratic</td>
</tr>
<tr>
<td align="center">iLQR</td>
<td align="center">Non-linear</td>
<td align="center">Yes</td>
<td align="center">Yes</td>
</tr>
</tbody></table>
<h2 id="Control"><a href="#Control" class="headerlink" title="Control"></a>Control</h2><p><img src="https://codimd.s3.shivering-isles.com/demo/uploads/upload_026ce76324175dab1af828975d49d3bf.png" alt=""></p>
<p>Position error in frame A:<br>$$<br>{}^{A}e = \begin{bmatrix}<br>x \ y<br>\end{bmatrix} - \begin{bmatrix}<br>x_{ref} \ y_{ref}<br>\end{bmatrix}<br>$$</p>
<p>We want position error in frame B so that $x$ and $y$ error correspond to along-track and cross-track error respectively:<br>$$<br>\begin{align<em>}<br>{}^{B}e &amp;= {}<em>A^{B} R {}^{A}e \<br>&amp;=R(-\theta</em>{ref}) \left( \begin{bmatrix}<br>x \ y<br>\end{bmatrix} - \begin{bmatrix}<br>x_{ref} \ y_{ref}<br>\end{bmatrix} \right) \<br>&amp;= \begin{bmatrix}<br>\cos \left(\theta_{r e f}\right)\left(x-x_{r e f}\right)+\sin \left(\theta_{r e f}\right)\left(y-y_{r e f}\right) \<br>-\sin \left(\theta_{r e f}\right)\left(x-x_{r e f}\right)+\cos \left(\theta_{r e f}\right)\left(y-y_{r e f}\right)<br>\end{bmatrix} \<br>&amp;= \begin{bmatrix}<br>e_{at} &amp; e_{ct}<br>\end{bmatrix}^T<br>\end{align</em>}<br>$$</p>
<p>Only consider cross-track error $e_{ct}$ and control steering angle for now.</p>
<h2 id="PID"><a href="#PID" class="headerlink" title="PID"></a>PID</h2><p>$$<br>u=-\left(K_{p} e_{c t}+K_{i} \int e_{c t}(t) d t+K_{d} \dot{e}_{c t}\right)<br>$$</p>
<p>where</p>
<ul>
<li>$K_p$: Proportional coefficient</li>
<li>$K_i$: Integral coefficient</li>
<li>$K_d$: Derivative coefficient</li>
</ul>
<p>Analytically compute the derivative term:<br>$$<br>\begin{align<em>}<br>\dot{e}<em>{c t} &amp;=-\sin \left(\theta</em>{ref}\right) \dot{x}+\cos \left(\theta_{ref}\right) \dot{y} \<br>&amp;=-\sin \left(\theta_{ref}\right) V \cos (\theta)+\cos \left(\theta_{ref}\right) V \sin (\theta) \<br>&amp;=V \sin \left(\theta-\theta_{ref}\right) \<br>&amp;=V \sin \left(\theta_{e}\right)<br>\end{align</em>}<br>$$</p>
<aside class="notice">
- what if numerically compute the derivative term?
- find example where Integral term is used. 通常用在有外力的情况? 比如要track的path是N极, 小车是S极(且$K_p$项和外力抵消, 则无法消除$e_{ct}$)
- 如果我们这个情况用$K_I$会发生什么?一开始会收敛很快?通常会给积分项$K_I$一个上限如果离reference path很远 是不是会在远处转圈圈?
</aside>

<h2 id="Pure-pursuit"><a href="#Pure-pursuit" class="headerlink" title="Pure-pursuit"></a>Pure-pursuit</h2><p><strong>Key idea</strong>: The car is always moving in a circular arc.</p>
<ol>
<li>Find a lookahead and compute arc</li>
<li>Move along the arc</li>
<li>Go to step 1</li>
</ol>
<p>Solve for arc:<br>$$<br>\alpha=\tan ^{-1}\left(\frac{y_{ref}-y}{x_{ref}-x}\right)-\theta \<br>R = \frac{L}{2 \sin\alpha} \<br>\dot{\theta} = \frac{V}{R} = \frac{2V\sin\alpha}{L} \<br>\dot{\theta} = \frac{V\tan u}{B}<br>$$</p>
<p>where $B$ is the car length. Solve for $u$ we can get<br>$$<br>u = \tan^{-1}\left( \frac{2B \sin \alpha}{L} \right)<br>$$</p>
<p><img src="https://codimd.s3.shivering-isles.com/demo/uploads/upload_9844cc32418a123e41c17e93270542ad.png" alt=""></p>
<h2 id="Lyapunov-control"><a href="#Lyapunov-control" class="headerlink" title="Lyapunov control"></a>Lyapunov control</h2><p>Define Lyapunov function:<br>$$<br>V\left(e_{ct}, \theta_{e}\right)=\frac{1}{2} k_{1} e_{ct}^{2}+\frac{1}{2} \theta_{e}^{2}<br>$$</p>
<p>Compute the derivative:<br>$$<br>\begin{align<em>}<br>\dot{V}\left(e_{c t}, \theta_{e}\right)&amp;=k_{1} e_{c t} \dot{e}<em>{c t}+\theta</em>{e} \dot{\theta}<em>{e}\<br>&amp;=k</em>{1} e_{c t} V \sin \theta_{e}+\theta_{e} \frac{V}{B} \tan u<br>\end{align</em>}<br>$$</p>
<p>Set $u$ to get $\dot{V} &lt; 0$:<br>$$<br>\theta_{e} \frac{V}{B} \tan u=-k_{1} e_{c t} V \sin \theta_{e}-k_{2} \theta_{e}^{2} \<br>\tan u=-\frac{k_{1} e_{c t} B}{\theta_{e}} \sin \theta_{e}-\frac{B}{V} k_{2} \theta_{e} \<br>u=\tan ^{-1}\left(-\frac{k_{1} e_{c t} B}{\theta_{e}} \sin \theta_{e}-\frac{B}{V} k_{2} \theta_{e}\right)<br>$$</p>
<h2 id="LQR"><a href="#LQR" class="headerlink" title="LQR"></a>LQR</h2><p>Turn the problem into an optimization to trade-off both driving error and keeping control action small:<br>$$<br>\min <em>{u(t)} \int</em>{0}^{\infty}\left(w_{1} e(t)^{2}+w_{2} u(t)^{2} \right) dt<br>$$</p>
<p>Given</p>
<ol>
<li><strong>Linear</strong> dynamic system<br>$$<br>x_{t+1} = Ax_t + Bu_t<br>$$</li>
<li><strong>Quadratic</strong> cost<br>$$<br>J=\sum_{t=0}^{T-1} x_{t}^{T} Q x_{t}+u_{t}^{T} R u_{t}<br>$$</li>
</ol>
<p>The optimal control sequence minimizing the cost is<br>$$<br>u_t = K_t x_t \<br>K_{t}=-\left(R+B^{T} V_{t+1} B\right)^{-1} B^{T} V_{t+1} A \<br>V_{t}=Q+K_{t}^{T} R K_{t}+\left(A+B K_{t}\right)^{T} V_{t+1}\left(A+B K_{t}\right)<br>$$</p>
<h2 id="MPC"><a href="#MPC" class="headerlink" title="MPC"></a>MPC</h2><ol>
<li>Plan a sequence of control actions</li>
<li>Predict the set of next states to a horizon H</li>
<li>Evaluate the cost/constraint of the states and controls</li>
<li>Optimize the cost</li>
</ol>
<aside class="notice">
- 主要就是error_cost + collision cost
- 如果error_cost 不用(x, y) Euclidian Distance, 儿用CrossTrack Error会发生什么？会倒着走么？PID和PurePursuit呢?Lypunov呢?
- 能不能把reference path里面每个waypoints的顺序用起来解决这个问题呢. 比如删掉之前用过的reference pose?
</aside>

<h2 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h2><p><code>controlnode.py</code>: main script</p>
<ol>
<li>Define Subscribers to pose and path infos; Publishers for visualization and Services for reset</li>
<li>Enter main program when initial pose is set and controller is ready. Get pose and reference pose, get next control and publish to <code>/vesc/high_level/ackermann_cmd_mux/input/nav_0</code> topic.</li>
<li>Stop when path is completed</li>
</ol>
<p><code>runner_script.py</code>:</p>
<ol>
<li>Loading different paths and speed</li>
<li>Start the controller</li>
</ol>
<p><code>controller.py</code>: base controller class</p>
<ol>
<li>Store path info</li>
<li>Define utility functions: get reference pose by index, get pose and pose_ref error</li>
</ol>
<p><mark>Find reference pose function is the same for all controllers: Find the nearest point on the path and lookahead some distance.</mark></p>
<p><code>pid.py</code>:</p>
<ol>
<li>Use PD equation to get next control (steering angle)</li>
</ol>
<p><code>purepursuit.py</code>:</p>
<ol>
<li>Use Purepursuit equation to get next control</li>
</ol>
<p><code>mpc.py</code>:</p>
<ol>
<li>Dividing steering angle $[-\pi, \pi]$ equally to $K$ rollouts</li>
<li>Execute each steering angel through $T$ timesteps to collect $K * T$ poses</li>
<li>Evaluate the cost of each rollout by collision cost and error cost<ol>
<li>Collision cost: if any pose in a trajectory is in collision with the map, add a large cost</li>
<li>Error cost: norm of the distance between last pose and the reference pose, weighted by a constant</li>
</ol>
</li>
<li>Choose the rollout with the minimal cost and execute the first step</li>
<li>Return to step 1</li>
</ol>
<p><code>mpc2.py</code>: Similar to mpc but use scan info rather than map. The only thing change is the obstacles cost.</p>
<ol>
<li>Calculate $N$ obstacles pose in the map by scan info</li>
<li>For $K * T$ poses, calculate the distance with every obstacles to get $K * T * N$ array</li>
<li>Find the minimal distance for every pose to get $K * T$ array</li>
<li>Average through timesteps to get $K$ array, then weighted by a constant to get the obstacles cost.</li>
</ol>
<p><code>nonlinear.py</code>:</p>
<ol>
<li>Use Lyapunov control equation to get the control</li>
</ol>
<h1 id="Lab3"><a href="#Lab3" class="headerlink" title="Lab3"></a>Lab3</h1><p>Steps for planing the path from one point to another:</p>
<ol>
<li>Random sample points on the map and construct the graph</li>
<li>Use planning algorithm (A*) to search the graph for optimal path</li>
</ol>
<h2 id="Graph-construction"><a href="#Graph-construction" class="headerlink" title="Graph construction"></a>Graph construction</h2><p>The graph we are constructing is called <a href="https://en.wikipedia.org/wiki/Random_geometric_graph" target="_blank" rel="noopener">Random geometric graph</a> (RGG)</p>
<ol>
<li>Sample a set of collision free vertices $V$</li>
<li>Connect neighboring vertices to get edges $E$</li>
</ol>
<h3 id="sampling"><a href="#sampling" class="headerlink" title="sampling"></a>sampling</h3><p>Uniform random sampling tends to clump. We want points to be spread out evenly, which can be achieved by <a href="https://observablehq.com/@jrus/halton" target="_blank" rel="noopener">Halton sequence</a></p>
<h3 id="optimal-radius"><a href="#optimal-radius" class="headerlink" title="optimal radius"></a>optimal radius</h3><p>We want to choose the radius smaller enough for efficiency while ensuring connectivity. The optimal value can be chosen as<br>$$<br>r = \left(\frac{\ln|V|}{\alpha_{p,d} |V|}\right)^{1/n}<br>$$<br>where $\alpha_{p,d}$ is a constant. For special case of a two-dimensional space and the euclidean norm ($d=2$, $p=2$), $\alpha_{p,d} = \pi$</p>
<h3 id="Dubins-path"><a href="#Dubins-path" class="headerlink" title="Dubins path"></a>Dubins path</h3><p>Since we are considering 2-D car dynamics, we need to connect two points with feasible path instead of straight lines. Mathematically, we need to solve the BVP:<br>$$<br>\dot{q}(t) = f(q(t), u(t)) \<br>q(0) = q_1,\quad q(t) = q_2<br>$$<br>where $q=(x,y,\theta)$ in our case.</p>
<p>Dubins path shows that the solution always exists and has to be one of 6 classes:<br>$$<br>{LRL, RLR, LSL, LSR, RSL, RSR}<br>$$<br>where $L,R,S$ represent turn left, right, straight, respectively.</p>
<h2 id="Planning-algorithm"><a href="#Planning-algorithm" class="headerlink" title="Planning algorithm"></a>Planning algorithm</h2><p>Given start node $s_0$, goal $s_1$ and cost $c(s, s’)$, create objects:</p>
<ol>
<li>OPEN: <strong>priority queue</strong> of nodes to be processed</li>
<li>CLOSED: list of nodes already processed</li>
<li>$g(s)$: estimate of the least cost from start to a given node</li>
</ol>
<p>The pseudocode for <strong>best first search</strong> can be expressed as</p>
<ol>
<li><p>Push $s_0$ into OPEN</p>
</li>
<li><p>While $s_1$ not expanded</p>
<ol start="3">
<li><p>Pop <em>best</em> from OPEN</p>
</li>
<li><p>Add <em>best</em> to CLOSED</p>
</li>
<li><p>For every successor <em>s’</em></p>
<ol start="6">
<li>If $g(s’) &gt; g(s) + c(s, s’)$<ol start="7">
<li>$g(s’) = g(s) + c(s, s’)$</li>
<li>Add (update) $s’$ to OPEN</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<p>The main problem is how to choose the heuristic function $f(s)$ for step 3.</p>
<h3 id="Djikstra’s-algorithm"><a href="#Djikstra’s-algorithm" class="headerlink" title="Djikstra’s algorithm"></a>Djikstra’s algorithm</h3><p>Choose $f(s) = g(s)$. Always pop the node with the smallest cost from the origin first.</p>
<h3 id="A"><a href="#A" class="headerlink" title="A*"></a>A*</h3><p>:::warning<br>看看这个<a href="http://theory.stanford.edu/~amitp/GameProgramming/AStarComparison.html" target="_blank" rel="noopener">astar</a><br>:::</p>
<p>If we can pre-evaluate the cost from the node to the goal $h(s)$, then we can choose a better $f(s) = g(s) + h(s)$.</p>
<ul>
<li>If $h(s)$ is admissible $h(s) \le h^<em>(s)$, $h(goal) = 0$, then the path return by A</em> is optimal.</li>
<li>If $h(s)$ is consistent $h(s) \le c(s, s’) + h(s’)$, $h(goal) = 0$, then A* is optimal and efficient (will not re-expand a node).</li>
</ul>
<p>All consistent heuristics are admissible, not vice versa.</p>
<h3 id="weighted-A"><a href="#weighted-A" class="headerlink" title="weighted A*"></a>weighted A*</h3><p>Choose $f(s) = g(s) + \epsilon h(s)$, where $\epsilon &gt; 1$. It is more efficient and the solution is $\epsilon$-optimal $c \le \epsilon c^*$</p>
<h3 id="lazy-A"><a href="#lazy-A" class="headerlink" title="lazy A*"></a>lazy A*</h3><p>Instead of checking edge collision for all neighbors, only check the edge to parent when expanding. <mark>OPEN list will have multiple copies of a node since we haven’t collision check.</mark></p>
<h3 id="shortcut"><a href="#shortcut" class="headerlink" title="shortcut"></a>shortcut</h3><p>After a path is found, we can randomly pick two nodes and connect them directly if the edge is collision-free.</p>
<h2 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h2><p><code>run.py</code>: main program</p>
<ol>
<li>Load map info</li>
<li>Construct graph given environment, sampler, number of vertices, connection radius.</li>
<li>Add start and end node</li>
<li>Use A* or lazy A* algorithm to search the optimal path and visualize</li>
</ol>
<p><code>MapEnvironment.py</code>: define utility functions associated with planning</p>
<ol>
<li>Check edge collision</li>
<li>Compute heuristic and distance function</li>
<li>Generate path on the map</li>
<li>Visualization of the graph and path</li>
</ol>
<p><code>Sampler.py</code>: create random samples for graph construction</p>
<ol>
<li>Use <a href="https://gist.github.com/tupui/cea0a91cc127ea3890ac0f002f887bae" target="_blank" rel="noopener">halton sequence</a> to generate 2-D random vertices in $(0,1)$</li>
<li>Scale by map info</li>
</ol>
<p><code>graph_maker.py</code>: construct graph</p>
<ol>
<li>Use python package <a href="https://networkx.github.io/" target="_blank" rel="noopener">NetworkX</a> to easily construct a graph</li>
<li>Add sampled valid vertices</li>
<li>Connect edges within radius and without collision (do not check collision if using lazy A*)</li>
</ol>
<p><code>astar.py</code>: A* algorithm</p>
<ol>
<li>Use <code>heapq</code> package to create priority queue to store <code>[f(s), count, node, g(s), parent]</code> info. <code>count</code> is used to prevent comparing node when $f(s)$ are the same.</li>
<li>Use dict <code>enqueued</code> to store $g(s)$ and $h(s)$ for a node, and another dict <code>explored</code> to store the explored node and its parent node.</li>
<li>Add start node to the queue.</li>
<li>While queue is not empty, pop one node and add it to <code>explored</code> if it is not already there.</li>
<li>For all the neighbor node $s’$, compute $g(s’) = g(s) + c(s,s’)$ if $s’$ is not already in <code>explored</code>.</li>
<li>If $s’$ is in <code>enqueued</code>, get its previous $g’(s’)$ and $h’(s’)$. Continue to next neighbor if $g’(s) \le g(s’)$, since it is better. If not in <code>enqueued</code>, compute $h(s’)$ by the heuristic function.</li>
<li>Update $g(s’)$ and $h(s’)$ in <code>enqueued</code> and push it to the queue.</li>
<li>If reach target node, continually find parent node by <code>explored</code> and return the path.</li>
</ol>
<p><code>lazy_astar.py</code>: lazy A* algorithm</p>
<ol>
<li>When expanding node, check its edge collision with parent.</li>
<li>When checking neighbors, do not need to compare $g’(s’)$ and $g(s’)$</li>
<li>Multiple nodes with different parents can be added to the queue.</li>
</ol>
<p><code>runDubins.py</code>:  similar to <code>run.py</code> but use Dubins environment</p>
<p><code>DubinsMapEnvironment.py</code>: inherited from <code>MapEnvironment</code></p>
<ol>
<li>Compute distances with Dubins path</li>
<li>Compute heuristic with Dubins path</li>
<li>Generate path by Dubins path planning</li>
</ol>
<p><code>DubinsSampler.py</code>:</p>
<ol>
<li>Sample $N$ vertices same as in <code>Sampler.py</code></li>
<li>Divide angles to $M$ parts, add angles to each vertices to create $M\times N$ samples</li>
</ol>
<p><code>Dubins.py</code>: utility function for Dubins path</p>
<p><code>ROSPlanner.py</code>: take goal from rviz and do planning. <mark>Be careful of the frame change between map and world</mark></p>
<ol>
<li>Load map info</li>
<li>Construct graph and save for later use</li>
<li>Subscribe to pose topic, save current pose</li>
<li>Subscribe to goal topic, plan from the current pose to the goal, publish the path using service defined in lab2</li>
<li>If there are multiple goals, sequentially planning through them and combine the path</li>
</ol>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol>
<li><a href="http://ais.informatik.uni-freiburg.de/teaching/ss13/robotics/" target="_blank" rel="noopener">Introduction to Mobile Robotics</a></li>
<li><a href="https://courses.cs.washington.edu/courses/cse490r/19sp/" target="_blank" rel="noopener">Mobile Robots</a></li>
<li><a href="http://www.probabilistic-robotics.org/" target="_blank" rel="noopener">Probabilistic Robotics</a></li>
</ol>
<p></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://thesong96.github.io/2020/03/18/Color-Recognition-of-Rubiks-Cube-CRRC-Review/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/baby.png">
      <meta itemprop="name" content="Nansong Yi">
      <meta itemprop="description" content="TheSong is named after IG.TheShy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TheSong">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/18/Color-Recognition-of-Rubiks-Cube-CRRC-Review/" class="post-title-link" itemprop="url">Color Recognition of Rubiks Cube - CRRC Review</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-03-18 14:34:20" itemprop="dateCreated datePublished" datetime="2020-03-18T14:34:20-07:00">2020-03-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-20 00:09:52" itemprop="dateModified" datetime="2020-03-20T00:09:52-07:00">2020-03-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/talk-to-myself/" itemprop="url" rel="index"><span itemprop="name">talk to myself</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="COLOR-RECOGNITION-FOR-RUBIK’S-CUBE-ROBOT"><a href="#COLOR-RECOGNITION-FOR-RUBIK’S-CUBE-ROBOT" class="headerlink" title="COLOR RECOGNITION FOR RUBIK’S CUBE ROBOT"></a><a href="https://arxiv.org/pdf/1901.03470.pdf" target="_blank" rel="noopener">COLOR RECOGNITION FOR RUBIK’S CUBE ROBOT</a></h2><h3 id="Problems"><a href="#Problems" class="headerlink" title="Problems"></a>Problems</h3><ul>
<li>Color Drifting(offline methods are always ineffectiveness and can not work well in continuous change circumstance.)<ul>
<li>When the brightness of the light changes, most of features of orange and red in the color space will shift, which result in the overlap distribution of orange and red colors. </li>
</ul>
</li>
</ul>
<h3 id="Approaches"><a href="#Approaches" class="headerlink" title="Approaches:"></a>Approaches:</h3><p>啥也不是 忍不住喷一下. 什么👻玩意儿, 就把KNN的distance metric加了个weight, 然后美其名曰Dynamicweightlabelpropagation, 菜. 就这也好意思放arxiv?</p>
<ul>
<li>Offline<ul>
<li>SB-ELM: Scatter balance &amp; extreme learning machine 看不懂这个、啥玩意儿啊！</li>
</ul>
</li>
<li>Online<ul>
<li>WLHP: 啥也不是. </li>
<li>WLHP*: Optimized WLHP. 啥也不是.</li>
<li>DWLP: 啥也不是.</li>
</ul>
</li>
</ul>
<h2 id="Rubiks-Cube-Localization-Face-Detection-and-Interactive-Solving"><a href="#Rubiks-Cube-Localization-Face-Detection-and-Interactive-Solving" class="headerlink" title="Rubiks Cube Localization, Face Detection, and Interactive Solving"></a><a href="http://cs231n.stanford.edu/reports/2015/pdfs/jaykevin_final.pdf" target="_blank" rel="noopener">Rubiks Cube Localization, Face Detection, and Interactive Solving</a></h2><h3 id="Approaches-1"><a href="#Approaches-1" class="headerlink" title="Approaches:"></a>Approaches:</h3><ul>
<li><p>Cube Localization via Convolutional Neural Networks</p>
</li>
<li><p>Finding Cube Pieces via SLIC Superpixel Classification</p>
<ul>
<li>Given an image, run MiniBatch Kmeans on pixel values and assign each pixel to its corresponding centroid to encourage clustering of similar pixels. (This helps with superpixel segmentation)</li>
<li>Run SLIC superpixel segmentation on the resulting Kmeans image, producing a set of candidate superpixels for cube pieces</li>
<li>For each candidate superpixel, we collect a histogram of HSV pixel values within and calculate up to the third moment of the covered area, appending all into a feature vector</li>
<li>Based on a random forest classifier trained on handlabelled ground-truth data, we then classify all resulting superpixels as cube piece or otherwise.<br><img src="https://i.imgur.com/g0nVVCD.png" alt="image-20200313001353864"></li>
</ul>
</li>
<li><p>Pinpointing Centers of Cube Faces?</p>
</li>
<li><p>Bootstrap Learning for Data Acquisition</p>
</li>
<li><p>Extracting Cube Face Information</p>
<ul>
<li><p>Given our predictions for the centers of the cube faces (and specifically, the corners of the center cube), we were able to calculate a projective transform to orient the cube and extract the color information from the faces. We were then able to classify the colors of each square by using a manually-tuned SVM????</p>
<p>  <img src="https://i.imgur.com/5PdAHJg.png" alt="image-20200318144148342"></p>
</li>
</ul>
</li>
</ul>
<hr>
<p>🌲莽莽问问题:</p>
<ul>
<li>rubix cube 的8个corner pieces总共有多少种orientation state? $3^8 / 3 = 3^7$ ?</li>
<li>rubix cube 的12个edge pieces总共有多少种orientation state?</li>
<li>So finally, what’s the the total number of state space?</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://thesong96.github.io/2020/03/12/RubixCube-Progress/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/baby.png">
      <meta itemprop="name" content="Nansong Yi">
      <meta itemprop="description" content="TheSong is named after IG.TheShy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TheSong">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/12/RubixCube-Progress/" class="post-title-link" itemprop="url">RubixCube Progress</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-03-12 22:45:20" itemprop="dateCreated datePublished" datetime="2020-03-12T22:45:20-07:00">2020-03-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-13 14:42:36" itemprop="dateModified" datetime="2020-03-13T14:42:36-07:00">2020-03-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/talk-to-myself/" itemprop="url" rel="index"><span itemprop="name">talk to myself</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Terminology praperation:</p>
<p><strong>face</strong>, <strong>sub-cubes</strong></p>
<p>a Rubik’s cube has 6 faces, each face has 9 sub-cubes.</p>
<h2 id="Previous-Work-Overview"><a href="#Previous-Work-Overview" class="headerlink" title="Previous Work Overview"></a><a href="https://www.youtube.com/watch?v=Kjj0HcvhKNU" target="_blank" rel="noopener">Previous Work Overview</a></h2><p><img src="https://i.imgur.com/GR2rHwj.png" alt="image-20200312224833356"></p>
<h2 id="My-Focus-Vision-Pose-Estimation"><a href="#My-Focus-Vision-Pose-Estimation" class="headerlink" title="My Focus: Vision + Pose Estimation"></a>My Focus: Vision + Pose Estimation</h2><h3 id="1-Vision-Rubix-Cube-Face-Detection"><a href="#1-Vision-Rubix-Cube-Face-Detection" class="headerlink" title="1. Vision: Rubix Cube Face Detection"></a>1. Vision: Rubix Cube Face Detection</h3><h4 id="Problems-from-old-algorithm"><a href="#Problems-from-old-algorithm" class="headerlink" title="Problems from old algorithm:"></a>Problems from old algorithm:</h4><p>(why Perception in real time: offline motion planning -&gt; online motion planning, cube state)</p>
<ul>
<li>Only using HSV color filter, sensitive to brigtness, background, camera exposure time, etc.<img src="https://i.imgur.com/5PpoioY.png" alt="image-20200312231316045"></li>
<li>Requires the cube to be at a fixed positon.</li>
</ul>
<p><img src="https://i.imgur.com/glB41wO.png" alt="image-20200312231701442"></p>
<h4 id="New-Approach"><a href="#New-Approach" class="headerlink" title="New Approach:"></a>New Approach:</h4><p>a) doesn’t require fixed position anymore.</p>
<ul>
<li>Object detection algorithm, such as Yolo, Faster-RCNN, will be used to draw a bounding box of Rubik’s Cube.</li>
<li>How to create Dataset? <a href="http://labelme.csail.mit.edu/Release3.0/" target="_blank" rel="noopener">MIT LabelMe</a>, see the following labeling example (including <strong>image with bounding box</strong> &amp; bounding box <strong>Description XML</strong> file).</li>
</ul>
<p><img src="https://i.imgur.com/wRWtuxF.png" alt="image-20200312234614078"></p>
<p>b) <strong>NOTE</strong> : This part(<strong>sub-cube color detection</strong>) needs more literature review to figure out the best way to extract color infomation</p>
<ul>
<li>Then we will get a cropped image that <strong>ONLY</strong> contains Rubik’s Cube</li>
</ul>
<p><img src="https://i.imgur.com/g0nVVCD.png" alt="image-20200313001353864"></p>
<ul>
<li>followed by a few traditional CV algorithms?<ul>
<li><a href="https://towardsdatascience.com/introduction-to-image-segmentation-with-k-means-clustering-83fd0a9e2fc3" target="_blank" rel="noopener">Kmeans</a></li>
<li><a href="https://jayrambhia.com/blog/superpixels-slic" target="_blank" rel="noopener">SLIC</a></li>
<li><a href="https://en.wikipedia.org/wiki/Canny_edge_detector" target="_blank" rel="noopener">Canny edge detector</a>, <a href="https://github.com/hkociemba/RubiksCube-TwophaseSolver" target="_blank" rel="noopener">RubiksCube-TwophaseSolver</a>?</li>
</ul>
</li>
<li>A small neural network doing regression to get the the center of 9 sub-cubes.</li>
<li>Use a SVM (or any other classifier?) to classify the colors near centers of 9 sub-cubes.</li>
</ul>
<h3 id="2-3D-Pose-Estimation-Position-Orientation"><a href="#2-3D-Pose-Estimation-Position-Orientation" class="headerlink" title="2.  3D Pose Estimation ( Position + Orientation )"></a>2.  3D Pose Estimation ( Position + Orientation )</h3><p><em>Actually this is a very difficult problem, see this <a href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=8972349" target="_blank" rel="noopener">benchmark paper</a></em> by <a href="https://homes.cs.washington.edu/~bolingy/" target="_blank" rel="noopener">Boling Yang</a> from CSE.</p>
<p><img src="https://i.imgur.com/COQFEjU.png" alt="image-20200313004912581"></p>
<ul>
<li><p><a href="https://www.youtube.com/watch?v=2R_wtJPTzQM" target="_blank" rel="noopener">Conventional Pose Estimation Method</a> 1. Model of Cube 2. Feature points are easy to extract</p>
<ul>
<li><p><strong>Postion</strong>(given by Bounding Box of obeject) + <strong>Depth</strong>(given by depth sensor, such as <a href="https://www.amazon.com/Intel-Realsense-D435-Webcam-FPS/dp/B07BLS5477/ref=sr_1_1?dchild=1&keywords=intel+realsense&qid=1584085987&sr=8-1" target="_blank" rel="noopener">Intel Real Sense Depth Camera</a>)</p>
<ul>
<li><p>See my derivation of <a href="https://thesong96.github.io/2020/02/27/Camera-Matrix/">Intrisic and Extrinsic Matrix</a> and <a href="http://www.cs.cmu.edu/~16385/s17/Slides/11.1_Camera_matrix.pdf" target="_blank" rel="noopener">Slides from CMU</a></p>
<p><img src="https://i.imgur.com/wIPFoTZ.png" alt="image-20200313005049644"></p>
</li>
</ul>
</li>
<li><p><strong>Orientaion</strong></p>
<ul>
<li>It might work? Need further comfirm(review code from another project).</li>
<li>Don’t have a very good idea now, even the one above works, the precision won’t be accurate enough to play Rubik’s Cube. But it should work on <strong>Inspection Robot</strong>, which Mike Gagnier is working on.</li>
</ul>
</li>
</ul>
</li>
<li><p>Learning Based 3D Pose Estimation Methods: Using Deep Learning (<strong>Can Estimate Orientation</strong>, but need to further check precision): </p>
<ul>
<li><a href="https://github.com/NVlabs/Deep_Object_Pose" target="_blank" rel="noopener">NVLabs DOPE</a></li>
<li><a href="https://github.com/yuxng/PoseCNN" target="_blank" rel="noopener">PoseCNN</a></li>
<li><a href="https://arxiv.org/pdf/1611.10010.pdf" target="_blank" rel="noopener">Deep Cuboid Detection: Beyond 2D Bounding Boxes</a></li>
</ul>
</li>
</ul>
<h2 id="My-work"><a href="#My-work" class="headerlink" title="My work"></a>My work</h2><p><img src="https://i.imgur.com/4N7cCip.png" alt="image-20200313011207210"></p>
<h3 id="Make-things-be-independent-of-hardware"><a href="#Make-things-be-independent-of-hardware" class="headerlink" title="Make things be independent of hardware"></a>Make things be independent of hardware</h3><ul>
<li><a href="https://github.com/macs-lab/avt_camera/blob/nansong/demo/2020win/src/avt_virtual.cpp" target="_blank" rel="noopener"><code>AVTCameraVirtual.cpp</code></a>, fake camera node publishing images to corresponding ROS topic.</li>
<li><strong>Why</strong>: development will be faster.</li>
</ul>
<h3 id="Successfully-Run-Detection-Algorithm-YOLOv3"><a href="#Successfully-Run-Detection-Algorithm-YOLOv3" class="headerlink" title="Successfully Run Detection Algorithm - YOLOv3"></a>Successfully Run Detection Algorithm - YOLOv3</h3><iframe src="https://drive.google.com/file/d/1sGPFjf89Tvn7T7r4yjPIvM7C4FuMsiPf/preview" width="640" height="480"></iframe>

<p>Open in your own browser: <a href="https://drive.google.com/file/d/1Fkj4UnyI5GAwdWwwG1ZFn23XGpjD4hsi/preview" target="_blank" rel="noopener">Video Link</a></p>
<ul>
<li><p><strong>Troubleshooting</strong>: </p>
<ul>
<li>too slow(FPS:0.1), why?? I have GPU on my desktop.</li>
</ul>
</li>
<li><p>need more work on <strong>Collecting Dataset</strong></p>
<ul>
<li>a better software tool helping collect data more effectively?</li>
</ul>
</li>
<li><p>Try other <strong>lastest implementation</strong> of detetion algorithms, since this one <a href="https://github.com/leggedrobotics/darknet_ros" target="_blank" rel="noopener">YOLO ROS: Real-Time Object Detection for ROS</a> is a little out of date.</p>
</li>
</ul>
<h3 id="Maintanence-of-lab-GitHub-repo-ROS-related-project"><a href="#Maintanence-of-lab-GitHub-repo-ROS-related-project" class="headerlink" title="Maintanence of lab GitHub repo, ROS related project"></a>Maintanence of lab GitHub repo, ROS related project</h3><ul>
<li><a href="https://github.com/macs-lab/macs-rosinstalls" target="_blank" rel="noopener">rosinstall, wstool</a>, easier to reproduce previous work</li>
<li><a href="https://catkin-tools.readthedocs.io/en/latest/" target="_blank" rel="noopener">catkin tool</a>, Why <code>catkin_tool</code> instead of <code>catkin_make</code> ?<ul>
<li><a href="https://catkin-tools.readthedocs.io/en/latest/cheat_sheet.html" target="_blank" rel="noopener">catkin_tools cheatsheet</a></li>
<li><a href="https://catkin-tools.readthedocs.io/en/latest/migration.html" target="_blank" rel="noopener">Migrating from catkin_make to catkin_tools &amp; differences</a></li>
</ul>
</li>
</ul>
<h2 id="Future-Work"><a href="#Future-Work" class="headerlink" title="Future Work"></a>Future Work</h2><ul>
<li>Run detection algorithm in real time</li>
<li>Collect rubix cube face dataset for detection </li>
<li>More literature review and experiments to find the best way to detect and classify colors on 9 sub-cubes</li>
<li>Talk to Hui more about Pose Estimation (Especially Estimate Orientaion)</li>
</ul>
<hr>
<h4 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h4><ul>
<li>Literature<ul>
<li><a href="http://cs231n.stanford.edu/reports/2015/pdfs/jaykevin_final.pdf" target="_blank" rel="noopener">Rubiks Cube Localization, Face Detection, and Interactive Solving</a></li>
<li><a href="https://drive.google.com/file/d/1WlT0NJI2aWvk0jPU5TzAIQqcgC3lDmKm/view?usp=sharing" target="_blank" rel="noopener">Automated Rubik’s Cube Recognition</a></li>
<li><a href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=8972349" target="_blank" rel="noopener">Benchmarking Robot Manipulation With the Rubik’s Cube</a></li>
</ul>
</li>
<li>Github<ul>
<li><a href="https://github.com/leggedrobotics/darknet_ros" target="_blank" rel="noopener">YOLO ROS: Real-Time Object Detection for ROS</a></li>
<li><a href="https://github.com/yehengchen/YOLOv3-ROS" target="_blank" rel="noopener">Real-time Screw Grasp Detection With ROS</a></li>
<li><a href="https://github.com/eriklindernoren/PyTorch-YOLOv3" target="_blank" rel="noopener">Pytorch Implementation of YOLOv3</a></li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://thesong96.github.io/2020/03/08/Python-Comments-Style/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/baby.png">
      <meta itemprop="name" content="Nansong Yi">
      <meta itemprop="description" content="TheSong is named after IG.TheShy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TheSong">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/08/Python-Comments-Style/" class="post-title-link" itemprop="url">Python Comments Style</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-03-08 22:21:41" itemprop="dateCreated datePublished" datetime="2020-03-08T22:21:41-07:00">2020-03-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-11 22:08:13" itemprop="dateModified" datetime="2020-03-11T22:08:13-07:00">2020-03-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Misc/" itemprop="url" rel="index"><span itemprop="name">Misc</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Google-Style"><a href="#Google-Style" class="headerlink" title="Google Style"></a>Google Style</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">"""Example Google style docstrings.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">This module demonstrates documentation as specified by the `Google Python</span></span><br><span class="line"><span class="string">Style Guide`_. Docstrings may extend over multiple lines. Sections are created</span></span><br><span class="line"><span class="string">with a section header and a colon followed by a block of indented text.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Example:</span></span><br><span class="line"><span class="string">    Examples can be given using either the ``Example`` or ``Examples``</span></span><br><span class="line"><span class="string">    sections. Sections support any reStructuredText formatting, including</span></span><br><span class="line"><span class="string">    literal blocks::</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        $ python example_google.py</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Section breaks are created by resuming unindented text. Section breaks</span></span><br><span class="line"><span class="string">are also implicitly created anytime a new section starts.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Attributes:</span></span><br><span class="line"><span class="string">    module_level_variable1 (int): Module level variables may be documented in</span></span><br><span class="line"><span class="string">        either the ``Attributes`` section of the module docstring, or in an</span></span><br><span class="line"><span class="string">        inline docstring immediately following the variable.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Either form is acceptable, but the two should not be mixed. Choose</span></span><br><span class="line"><span class="string">        one convention to document module level variables and be consistent</span></span><br><span class="line"><span class="string">        with it.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Todo:</span></span><br><span class="line"><span class="string">    * For module TODOs</span></span><br><span class="line"><span class="string">    * You have to also use ``sphinx.ext.todo`` extension</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.. _Google Python Style Guide:</span></span><br><span class="line"><span class="string">   http://google.github.io/styleguide/pyguide.html</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">module_level_variable1 = <span class="number">12345</span></span><br><span class="line"></span><br><span class="line">module_level_variable2 = <span class="number">98765</span></span><br><span class="line"><span class="string">"""int: Module level variable documented inline.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The docstring may span multiple lines. The type may optionally be specified</span></span><br><span class="line"><span class="string">on the first line, separated by a colon.</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">function_with_types_in_docstring</span><span class="params">(param1, param2)</span>:</span></span><br><span class="line">    <span class="string">"""Example function with types documented in the docstring.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    `PEP 484`_ type annotations are supported. If attribute, parameter, and</span></span><br><span class="line"><span class="string">    return types are annotated according to `PEP 484`_, they do not need to be</span></span><br><span class="line"><span class="string">    included in the docstring:</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        param1 (int): The first parameter.</span></span><br><span class="line"><span class="string">        param2 (str): The second parameter.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        bool: The return value. True for success, False otherwise.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    .. _PEP 484:</span></span><br><span class="line"><span class="string">        https://www.python.org/dev/peps/pep-0484/</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">function_with_pep484_type_annotations</span><span class="params">(param1: int, param2: str)</span> -&gt; bool:</span></span><br><span class="line">    <span class="string">"""Example function with PEP 484 type annotations.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        param1: The first parameter.</span></span><br><span class="line"><span class="string">        param2: The second parameter.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        The return value. True for success, False otherwise.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">module_level_function</span><span class="params">(param1, param2=None, *args, **kwargs)</span>:</span></span><br><span class="line">    <span class="string">"""This is an example of a module level function.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Function parameters should be documented in the ``Args`` section. The name</span></span><br><span class="line"><span class="string">    of each parameter is required. The type and description of each parameter</span></span><br><span class="line"><span class="string">    is optional, but should be included if not obvious.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    If \*args or \*\*kwargs are accepted,</span></span><br><span class="line"><span class="string">    they should be listed as ``*args`` and ``**kwargs``.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    The format for a parameter is::</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">        name (type): description</span></span><br><span class="line"><span class="string">            The description may span multiple lines. Following</span></span><br><span class="line"><span class="string">            lines should be indented. The "(type)" is optional.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">            Multiple paragraphs are supported in parameter</span></span><br><span class="line"><span class="string">            descriptions.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        param1 (int): The first parameter.</span></span><br><span class="line"><span class="string">        param2 (:obj:`str`, optional): The second parameter. Defaults to None.</span></span><br><span class="line"><span class="string">            Second line of description should be indented.</span></span><br><span class="line"><span class="string">        *args: Variable length argument list.</span></span><br><span class="line"><span class="string">        **kwargs: Arbitrary keyword arguments.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        bool: True if successful, False otherwise.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">        The return type is optional and may be specified at the beginning of</span></span><br><span class="line"><span class="string">        the ``Returns`` section followed by a colon.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">        The ``Returns`` section may span multiple lines and paragraphs.</span></span><br><span class="line"><span class="string">        Following lines should be indented to match the first line.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">        The ``Returns`` section supports any reStructuredText formatting,</span></span><br><span class="line"><span class="string">        including literal blocks::</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">            &#123;</span></span><br><span class="line"><span class="string">                'param1': param1,</span></span><br><span class="line"><span class="string">                'param2': param2</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Raises:</span></span><br><span class="line"><span class="string">        AttributeError: The ``Raises`` section is a list of all exceptions</span></span><br><span class="line"><span class="string">            that are relevant to the interface.</span></span><br><span class="line"><span class="string">        ValueError: If `param2` is equal to `param1`.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">if</span> param1 == param2:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">'param1 may not be equal to param2'</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">example_generator</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="string">"""Generators have a ``Yields`` section instead of a ``Returns`` section.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        n (int): The upper limit of the range to generate, from 0 to `n` - 1.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Yields:</span></span><br><span class="line"><span class="string">        int: The next number in the range of 0 to `n` - 1.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Examples:</span></span><br><span class="line"><span class="string">        Examples should be written in doctest format, and should illustrate how</span></span><br><span class="line"><span class="string">        to use the function.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; print([i for i in example_generator(4)])</span></span><br><span class="line"><span class="string">        [0, 1, 2, 3]</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">        <span class="keyword">yield</span> i</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExampleError</span><span class="params">(Exception)</span>:</span></span><br><span class="line">    <span class="string">"""Exceptions are documented in the same way as classes.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    The __init__ method may be documented in either the class level</span></span><br><span class="line"><span class="string">    docstring, or as a docstring on the __init__ method itself.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Either form is acceptable, but the two should not be mixed. Choose one</span></span><br><span class="line"><span class="string">    convention to document the __init__ method and be consistent with it.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Note:</span></span><br><span class="line"><span class="string">        Do not include the `self` parameter in the ``Args`` section.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        msg (str): Human readable string describing the exception.</span></span><br><span class="line"><span class="string">        code (:obj:`int`, optional): Error code.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Attributes:</span></span><br><span class="line"><span class="string">        msg (str): Human readable string describing the exception.</span></span><br><span class="line"><span class="string">        code (int): Exception error code.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, msg, code)</span>:</span></span><br><span class="line">        self.msg = msg</span><br><span class="line">        self.code = code</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExampleClass</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">"""The summary line for a class docstring should fit on one line.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    If the class has public attributes, they may be documented here</span></span><br><span class="line"><span class="string">    in an ``Attributes`` section and follow the same formatting as a</span></span><br><span class="line"><span class="string">    function's ``Args`` section. Alternatively, attributes may be documented</span></span><br><span class="line"><span class="string">    inline with the attribute's declaration (see __init__ method below).</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Properties created with the ``@property`` decorator should be documented</span></span><br><span class="line"><span class="string">    in the property's getter method.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Attributes:</span></span><br><span class="line"><span class="string">        attr1 (str): Description of `attr1`.</span></span><br><span class="line"><span class="string">        attr2 (:obj:`int`, optional): Description of `attr2`.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, param1, param2, param3)</span>:</span></span><br><span class="line">        <span class="string">"""Example of docstring on the __init__ method.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">        The __init__ method may be documented in either the class level</span></span><br><span class="line"><span class="string">        docstring, or as a docstring on the __init__ method itself.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">        Either form is acceptable, but the two should not be mixed. Choose one</span></span><br><span class="line"><span class="string">        convention to document the __init__ method and be consistent with it.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">        Note:</span></span><br><span class="line"><span class="string">            Do not include the `self` parameter in the ``Args`` section.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            param1 (str): Description of `param1`.</span></span><br><span class="line"><span class="string">            param2 (:obj:`int`, optional): Description of `param2`. Multiple</span></span><br><span class="line"><span class="string">                lines are supported.</span></span><br><span class="line"><span class="string">            param3 (:obj:`list` of :obj:`str`): Description of `param3`.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        self.attr1 = param1</span><br><span class="line">        self.attr2 = param2</span><br><span class="line">        self.attr3 = param3  <span class="comment">#: Doc comment *inline* with attribute</span></span><br><span class="line">    </span><br><span class="line">        <span class="comment">#: list of str: Doc comment *before* attribute, with type specified</span></span><br><span class="line">        self.attr4 = [<span class="string">'attr4'</span>]</span><br><span class="line">    </span><br><span class="line">        self.attr5 = <span class="literal">None</span></span><br><span class="line">        <span class="string">"""str: Docstring *after* attribute, with type specified."""</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">readonly_property</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""str: Properties should be documented in their getter method."""</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'readonly_property'</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">readwrite_property</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">""":obj:`list` of :obj:`str`: Properties with both a getter and setter</span></span><br><span class="line"><span class="string">        should only be documented in their getter method.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">        If the setter method contains notable behavior, it should be</span></span><br><span class="line"><span class="string">        mentioned here.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">return</span> [<span class="string">'readwrite_property'</span>]</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @readwrite_property.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">readwrite_property</span><span class="params">(self, value)</span>:</span></span><br><span class="line">        value</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">example_method</span><span class="params">(self, param1, param2)</span>:</span></span><br><span class="line">        <span class="string">"""Class methods are similar to regular functions.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">        Note:</span></span><br><span class="line"><span class="string">            Do not include the `self` parameter in the ``Args`` section.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            param1: The first parameter.</span></span><br><span class="line"><span class="string">            param2: The second parameter.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            True if successful, False otherwise.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__special__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""By default special members with docstrings are not included.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">        Special members are any methods or attributes that start with and</span></span><br><span class="line"><span class="string">        end with a double underscore. Any special member with a docstring</span></span><br><span class="line"><span class="string">        will be included in the output, if</span></span><br><span class="line"><span class="string">        ``napoleon_include_special_with_doc`` is set to True.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">        This behavior can be enabled by changing the following setting in</span></span><br><span class="line"><span class="string">        Sphinx's conf.py::</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">            napoleon_include_special_with_doc = True</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__special_without_docstring__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_private</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""By default private members are not included.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">        Private members are any methods or attributes that start with an</span></span><br><span class="line"><span class="string">        underscore and are *not* special. By default they are not included</span></span><br><span class="line"><span class="string">        in the output.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">        This behavior can be changed such that private members *are* included</span></span><br><span class="line"><span class="string">        by changing the following setting in Sphinx's conf.py::</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">            napoleon_include_private_with_doc = True</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_private_without_docstring</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>




      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://thesong96.github.io/2020/02/28/Review-Transfer-depends-on-Acquisition-Analyzing-Manipulation-Strategies/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/baby.png">
      <meta itemprop="name" content="Nansong Yi">
      <meta itemprop="description" content="TheSong is named after IG.TheShy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TheSong">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/02/28/Review-Transfer-depends-on-Acquisition-Analyzing-Manipulation-Strategies/" class="post-title-link" itemprop="url">Review - Transfer depends on Acquisition: Analyzing Manipulation Strategies for Robotic Feeding</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-02-28 15:17:42" itemprop="dateCreated datePublished" datetime="2020-02-28T15:17:42-08:00">2020-02-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-11 22:13:47" itemprop="dateModified" datetime="2020-03-11T22:13:47-07:00">2020-03-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/PRL/" itemprop="url" rel="index"><span itemprop="name">PRL</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>Goal</strong>:</p>
<ul>
<li>review SPNet<ul>
<li>Dense Block需要搞明白.</li>
</ul>
</li>
<li>What is BLD ??????</li>
<li>review dataset </li>
</ul>
<hr>
<h3 id="SPNet"><a href="#SPNet" class="headerlink" title="SPNet"></a>SPNet</h3><p>Skewering Position Network</p>
<p><img src="https://i.imgur.com/4HVZJjk.png" alt="spnet"></p>
<ul>
<li><p>Dense Block? we have two version of SPNet (shallow/dense). A shallower version() has 3 and 6 inner layers in each dense block and a deeper version has 6 and 12 inner layers respectively.</p>
</li>
<li><p>We tested multiple versions of SPNet with varying dense block sizes and angle resolutions. All the network variants including the simple SPNet were trained with the dataset until the training loss stabilized, and for the binary masks, they reached a similar test accuracy of 96.5%. However, the <code>F1 score</code> of the dense block SPNet was 11.76% higher than the simple SPNet. The <code>recall</code> of the dense block SPNet was higher than that of the simple SPNet while their precisions were similar.</p>
<ul>
<li>what’s the difference between simple and dense block SPNet?</li>
<li>recap criteria: F1 score, recall, true positive, false negative, etc </li>
</ul>
</li>
<li><p>Rotation Mask, according to the tutorial script, pred_rmasks.shape = (1, 289, 19) why 19?</p>
</li>
<li><p>The rotation mask consists of 17 × 17 × a grid cells, where a is the angle resolution represented by the number of classes for the discretized angles between [0, π).</p>
</li>
<li><p>why discretized angles to <code>#a</code> classes: </p>
<ul>
<li>the rotation classification was more reliable than rotation regression for our early test cases.</li>
<li>we can handle the rotation free annotation as a class among other specific rotations. <ul>
<li>(rotation free? means any rotation is ok for that food item, according to the note below)</li>
</ul>
</li>
<li>here, we set angle resolution to be 18, there are a total of 19 classes: class 0 represents any rotation while class 1 ∼ 18 denote specific angles, $(class id−1)×10°$. `````````````````</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torchvision.transforms <span class="keyword">as</span> transforms</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> bite_selection_package.model.spnet <span class="keyword">import</span> DenseSPNet</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">spnet_tutorial</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># initialize DenseSPNet and load the trained checkpoint</span></span><br><span class="line">    spnet = DenseSPNet()</span><br><span class="line">    checkpoint = torch.load(<span class="string">'../checkpoint/spnet_ckpt.pth'</span>)</span><br><span class="line">    spnet.load_state_dict(checkpoint[<span class="string">'net'</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># prepare an input image</span></span><br><span class="line">    img = Image.open(<span class="string">'./sample.jpg'</span>)</span><br><span class="line">    img = img.resize((<span class="number">136</span>, <span class="number">136</span>))</span><br><span class="line">    trans = transforms.ToTensor()</span><br><span class="line">    inp = torch.stack([trans(img)])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># get predictions</span></span><br><span class="line">    spnet.eval()</span><br><span class="line">    pred_bmasks, pred_rmasks = spnet(inp)</span><br><span class="line"></span><br><span class="line">    print(pred_bmasks.shape, pred_rmasks.shape)</span><br><span class="line">    <span class="comment"># print and visualize predicted masks</span></span><br><span class="line">    print(<span class="string">'rotation mask: '</span>)</span><br><span class="line">    print(pred_rmasks.data)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">'visualize binary mask for skewering locations'</span>)</span><br><span class="line">    bm_arr = pred_bmasks.data[<span class="number">0</span>].sigmoid().view(<span class="number">17</span>, <span class="number">17</span>).numpy()</span><br><span class="line"></span><br><span class="line">    print(bm_arr.shape)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    spnet_tutorial()</span><br></pre></td></tr></table></figure>

<ul>
<li>why not <code>Mask-RCNN</code>: We developed SPNet running on top of RetinaNet instead of extending Mask RCNN because we do not need pixel-wise mask generation and masks over the entire input scene – SPNet runs only for the food item we want to acquire.</li>
<li>why dense block: we adopt the dense block structure from <code>DenseNet</code> in order to increase the representation power of the network.</li>
</ul>
<h3 id="DataSet"><a href="#DataSet" class="headerlink" title="DataSet"></a>DataSet</h3><p><img src="https://i.imgur.com/J0KEEId.png" alt="SPNet prformance"></p>
<ul>
<li><p>small: Cantaloupes, bananas, and strawberries</p>
<p>  long: carrots and celeries</p>
<p>  round: eggs</p>
<p>  We generated the masks with specific rules for each category for effective feeding, so that SPNet learns our category-dependent strategies (see Fig.4), like skewering long items at their ends with the tines perpendicular(fork tine?? 怎么个垂直，是fork的切面?) to the item’s long axis.</p>
</li>
</ul>
<h3 id="Bite-Acquisition-Experiments"><a href="#Bite-Acquisition-Experiments" class="headerlink" title="Bite Acquisition Experiments"></a>Bite Acquisition Experiments</h3><ul>
<li><p>Using each of these strategies, ourautonomous robotic system skewered 2 plates of 5 pieces of each of these 6 food items, thus totalling to 3 skewering position strategies × 2 plates × 5 pieces × 6 food items = 180 trials. <strong>Since both the baseline and SPNet methods are capable of letting the user select the food item to acquire, our system attempted skewering each item only once</strong>. This is in contrast to BLD, which doesn’t let the user choose and thus is free to retry food items. We restrict BLD to 30 attempts to match the number of trials used for the other methods</p>
</li>
<li><p><strong>check the experiment video to see how exactly we do it</strong>. </p>
<p>  For two of the food items, bananas, and strawberries, we also compared two skewering approach angle strategies: <em>vertical and angled</em>. We had two discrete manipulation primitives for the angled primitive, one with horizontal tines and one with vertical. Bananas often slip off the fork, so we tilted the fork by 45 degrees to orient the tines more horizontally. When skewering strawberries, the tines tend to slip on the rounded surface without penetrating it. Therefore, we tilted the fork in the other direction to so that the tines skewered the strawberry vertically. Using SPNet, we skewered 2 plates of 5 items for bananas and strawberries, resulting in 20 additional trials which we compared with the vertical performance of the above experiment.<img src="https://i.imgur.com/zb9XuEk.jpg" alt="image-20200304155034047"></p>
</li>
<li></li>
</ul>
<hr>
<p><strong>憨憨学英语</strong>🌲</p>
<ul>
<li>Heterogeneous 异构的</li>
<li>slender 苗条的</li>
<li>yolk 蛋黄</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://thesong96.github.io/2020/02/28/torch-review-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/baby.png">
      <meta itemprop="name" content="Nansong Yi">
      <meta itemprop="description" content="TheSong is named after IG.TheShy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TheSong">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/02/28/torch-review-1/" class="post-title-link" itemprop="url">torch review 1</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-02-28 13:49:03" itemprop="dateCreated datePublished" datetime="2020-02-28T13:49:03-08:00">2020-02-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-11 22:02:45" itemprop="dateModified" datetime="2020-03-11T22:02:45-07:00">2020-03-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/PyTorch/" itemprop="url" rel="index"><span itemprop="name">PyTorch</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Goal:</p>
<ul>
<li>torchvision.transforms 在干嘛</li>
<li>torch.utils.data.Dataset 怎么写成自己的dataset</li>
</ul>
<hr>
<h3 id="torchvision-transforms"><a href="#torchvision-transforms" class="headerlink" title="torchvision.transforms"></a>torchvision.transforms</h3><h3 id="torch-utils-data-Dataset"><a href="#torch-utils-data-Dataset" class="headerlink" title="torch.utils.data.Dataset"></a>torch.utils.data.Dataset</h3><h3 id="零碎"><a href="#零碎" class="headerlink" title="零碎"></a>零碎</h3><ul>
<li>The <code>.data</code> field is an old field that is kept for backward compatibility but should not be used anymore as it’s usage is dangerous and can make computations wrong. You should use <code>.detach()</code> and/or <code>with torch.no_grad()</code> instead now.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">_, predicted = torch.max(outputs.data, <span class="number">1</span>)</span><br><span class="line">print(pred_rmasks.data)</span><br></pre></td></tr></table></figure>

<ul>
<li><p><code>layer.eval()</code>eval表示不计算back propagation</p>
</li>
<li><p>Implement <code>def __getitem__(self, idx):</code> 一定要有idx吗？这个就会影响: <code>for batch_idx, batch_items in enumerate(trainloader):</code></p>
</li>
<li><p>经常看到这句话 他究竟在干嘛……读完数据马上测试吗?</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">'[spdataset] test'</span>)</span><br><span class="line">    ds = SPDataset(</span><br><span class="line">        list_filename=config.test_list_filename,</span><br><span class="line">        train=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">import</span> IPython; IPython.embed()</span><br></pre></td></tr></table></figure>

</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://thesong96.github.io/2020/02/27/Optical-Flow/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/baby.png">
      <meta itemprop="name" content="Nansong Yi">
      <meta itemprop="description" content="TheSong is named after IG.TheShy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TheSong">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/02/27/Optical-Flow/" class="post-title-link" itemprop="url">Optical Flow</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-02-27 16:55:31" itemprop="dateCreated datePublished" datetime="2020-02-27T16:55:31-08:00">2020-02-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-11 21:39:20" itemprop="dateModified" datetime="2020-03-11T21:39:20-07:00">2020-03-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://thesong96.github.io/2020/02/27/Camera-Matrix/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/baby.png">
      <meta itemprop="name" content="Nansong Yi">
      <meta itemprop="description" content="TheSong is named after IG.TheShy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TheSong">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/02/27/Camera-Matrix/" class="post-title-link" itemprop="url">Camera Matrix</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-02-27 16:46:05" itemprop="dateCreated datePublished" datetime="2020-02-27T16:46:05-08:00">2020-02-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-13 16:04:59" itemprop="dateModified" datetime="2020-03-13T16:04:59-07:00">2020-03-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Computer-Vision/" itemprop="url" rel="index"><span itemprop="name">Computer Vision</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="Frame-Transformations-review-for-Extrinsic-matrix"><a href="#Frame-Transformations-review-for-Extrinsic-matrix" class="headerlink" title="Frame Transformations review (for Extrinsic matrix)"></a>Frame Transformations review (for Extrinsic matrix)</h3><ul>
<li>Extrinsic camera matrix</li>
</ul>
<iframe src="https://drive.google.com/file/d/1_T0T3IL8m15mz5IoSMLmsSiPUD4qBPea/preview" width="640" height="480"></iframe>

<h3 id="Pinhole-Camera-Intrinsic-Matrix"><a href="#Pinhole-Camera-Intrinsic-Matrix" class="headerlink" title="Pinhole Camera(Intrinsic Matrix)"></a>Pinhole Camera(Intrinsic Matrix)</h3><p><img src="https://i.imgur.com/ZSkkMxd.png" alt="Imgur"></p>
<h3 id="Merge-them"><a href="#Merge-them" class="headerlink" title="Merge them"></a>Merge them</h3><iframe src="https://drive.google.com/file/d/1Rs647iuzPi4yc0JSkKuWH0yvzcOvYjq8/preview" width="640" height="480"></iframe>

<p>有了上述的 投影公式 $P = K[R|t]$, 既可以从3D到2D, 如果能有real sense这样带depth sensor的camera, 那就可以粗略估计Z(in camera frame), 就能反算world frame的坐标了</p>
<h3 id="Questions"><a href="#Questions" class="headerlink" title="Questions:"></a>Questions:</h3><ul>
<li>有了camera的3d -&gt; 2d的投影关系原理清楚之后，常常听到人说要做camera calibration, 那这个calibration究竟在cali个什么、是intrinsic parameter还是extrinsic frame transform?</li>
<li>如上所述, 如果有depth image, 那可以3D坐标和2D坐标随意转换、但是pose呢? orientation呢? 但是好像理论上也可以? 比如被detect的物体上随意找3个点反算出来world frame的坐标, 那三个点不就确定了pose么? 但是实际可操作么? 滚回去看看代码.</li>
<li>Other One-Stage 3D Pose Estimation Methods: <ul>
<li><a href="https://github.com/NVlabs/Deep_Object_Pose" target="_blank" rel="noopener">NVLabs DOPE</a></li>
<li><a href="https://github.com/yuxng/PoseCNN" target="_blank" rel="noopener">PoseCNN</a></li>
<li><a href="https://arxiv.org/pdf/1611.10010.pdf" target="_blank" rel="noopener">Deep Cuboid Detection: Beyond 2D Bounding Boxes</a></li>
</ul>
</li>
</ul>
<h3 id="Photography-Basic"><a href="#Photography-Basic" class="headerlink" title="Photography Basic"></a>Photography Basic</h3><ul>
<li><a href="https://improvephotography.com/photography-basics/aperture-shutter-speed-and-iso/" target="_blank" rel="noopener">Photography Basics 101: Aperture, Shutter speed, and ISO</a></li>
</ul>
<hr>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul>
<li><a href="http://www.cs.cmu.edu/~16385/s17/Slides/11.1_Camera_matrix.pdf" target="_blank" rel="noopener">CMU 16385 Camera Matrix</a></li>
</ul>
<hr>
<p>🌲憨憨学英语</p>
<ul>
<li>Camera obscura 暗箱</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://thesong96.github.io/2020/02/27/Latex-Math-Cheat-Sheet/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/baby.png">
      <meta itemprop="name" content="Nansong Yi">
      <meta itemprop="description" content="TheSong is named after IG.TheShy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TheSong">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/02/27/Latex-Math-Cheat-Sheet/" class="post-title-link" itemprop="url">Latex Math Cheat Sheet</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-02-27 15:04:21" itemprop="dateCreated datePublished" datetime="2020-02-27T15:04:21-08:00">2020-02-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-20 00:14:40" itemprop="dateModified" datetime="2020-03-20T00:14:40-07:00">2020-03-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/latex/" itemprop="url" rel="index"><span itemprop="name">latex</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li>对齐的左右等式</li>
<li>坚果云markdown不支持mathjax.<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">\begin&#123;align&#125;</span><br><span class="line">e^&#123;\pi&#125; &amp;? \pi^e \\</span><br><span class="line">\pi \ln(e) &amp;? e\ln(\pi) \\</span><br><span class="line">\frac&#123;\ln(e)&#125;&#123;e&#125; &amp;? \frac&#123;\ln(\pi)&#125;&#123;\pi&#125; \\</span><br><span class="line">f(x) &amp;&#x3D; \frac&#123;\ln(x)&#125;&#123;x&#125; \\</span><br><span class="line">f&#39;(x) &amp;&#x3D; \frac&#123;1-\ln(x)&#125;&#123;x^2&#125; \\</span><br><span class="line">f&#39;(x) &amp;&lt; 0, x&gt;e \\</span><br><span class="line">\Rightarrow f(e) &amp;&gt; f(\pi) \\</span><br><span class="line">e^&#123;\pi&#125; &amp;&gt; \pi^e </span><br><span class="line">\end&#123;align&#125;</span><br></pre></td></tr></table></figure>
$\sum_i^n f_i(x)$</li>
</ul>
<p>$$<br>\begin{align}<br>e^{\pi} &amp;? \pi^e \<br>\pi \ln(e) &amp;? e\ln(\pi) \<br>\frac{\ln(e)}{e} &amp;? \frac{\ln(\pi)}{\pi} \<br>f(x) &amp;= \frac{\ln(x)}{x} \<br>f’(x) &amp;= \frac{1-\ln(x)}{x^2} \<br>f’(x) &amp;&lt; 0, x&gt;e \<br>\Rightarrow f(e) &amp;&gt; f(\pi) \<br>e^{\pi} &amp;&gt; \pi^e<br>\end{align}<br>$$</p>
<ul>
<li>联立解方程</li>
<li></li>
</ul>
<p>$f’(x) = \frac{1-\ln(x)}{x^2}$</p>
<p>$M g \sin \theta-\mu m g \cos \theta=(M+m) a$<br>$M g \sin \theta-\mu m g \cos \theta=(M+m) a$<br>Mysino- $\mu$ mgcoso $=(M+m) a$</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Nansong Yi"
      src="/images/baby.png">
  <p class="site-author-name" itemprop="name">Nansong Yi</p>
  <div class="site-description" itemprop="description">TheSong is named after IG.TheShy</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">18</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/nansongyi" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;nansongyi" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:nansong@uw.edu" title="E-Mail → mailto:nansong@uw.edu" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-link"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="http://nansongyi.me/" title="http:&#x2F;&#x2F;nansongyi.me" rel="noopener" target="_blank">my web</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://silencial.github.io/" title="https:&#x2F;&#x2F;silencial.github.io&#x2F;" rel="noopener" target="_blank">silencial</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://3monks.org/en/" title="https:&#x2F;&#x2F;3monks.org&#x2F;en&#x2F;" rel="noopener" target="_blank">sky</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.twistedwg.com/pages/class.html" title="http:&#x2F;&#x2F;www.twistedwg.com&#x2F;pages&#x2F;class.html" rel="noopener" target="_blank">twistedwg</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Nansong Yi</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.getAttribute('pjax') !== null) {
      script.setAttribute('pjax', '');
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  




  
<script src="//cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script>
<script src="//cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script>
<script src="/js/algolia-search.js"></script>














    <div id="pjax">
  

  

  

    </div>
</body>
</html>
